{"ast":null,"code":"import { currentObjects, setCurrentObjects } from \"../UIElements/CanvasDraw\";\nimport { version } from \"../MainProgram\";\nimport { Vertex } from \"../DataStructures/Vertex\";\nimport { Arrow } from \"../DataStructures/Arrow\";\nexport function save() {\n  console.log(JSON.stringify(currentObjects)); // Combine into save data\n\n  var saveData = {\n    // The version is being saved in the savefile\n    // this is so in future versions, if the serialisation changes\n    // They can upgrade the the file to one compatibile with the newer version\n    version: version,\n    // The data here should all have uuids and should be convertible back into their objects.\n    currentObjects: currentObjects\n  };\n  var dataStr = \"data:text/json;charset=utf-8,\" + encodeURIComponent(JSON.stringify(saveData));\n  var downloadElem = document.getElementById('json-downloader');\n  downloadElem.setAttribute(\"href\", dataStr);\n  downloadElem.setAttribute(\"download\", \"export.json\");\n}\nexport function open(jsonString) {\n  if (jsonString == null) return;\n\n  try {\n    // TODO Add check to see if there is unsaved progress\n    var loadedJSON = JSON.parse(jsonString); // Loaded objects ONLY with variables\n\n    var loadedObjects = loadedJSON.currentObjects; // Loaded objects with variables and functions\n\n    var newObjects = []; // Copy behaviour over (vertexs first)\n\n    loadedObjects.forEach(item => {\n      if (item !== undefined) {\n        switch (item.name) {\n          case \"Vertex\":\n            var newVertex = new Vertex(item.UUID, item.title, item.content, item.sx, item.sy, item.width, item.height);\n            newObjects.push(newVertex);\n            break;\n\n          default:\n            break;\n        }\n      }\n    }); // Copy behaviour over (everything else)\n\n    loadedObjects.forEach(item => {\n      if (item !== undefined) {\n        switch (item.name) {\n          case \"Vertex\":\n            break;\n\n          case \"Arrow\":\n            var newArrow = new Arrow(item.UUID, newObjects, item.fromVertexUUID, item.fromVertexNode, item.toVertexUUID, item.toVertexNode);\n            newObjects.push(newArrow);\n            break;\n\n          default:\n            console.error(\"Unknown object to deserialise \", item);\n            break;\n        }\n      }\n    });\n    console.log(newObjects);\n    setCurrentObjects(newObjects);\n  } catch (e) {\n    alert(e);\n  }\n}","map":{"version":3,"sources":["/ocean/pacific/University/2020/IFB398/overdrive/src/Serialisation/FileManager.js"],"names":["currentObjects","setCurrentObjects","version","Vertex","Arrow","save","console","log","JSON","stringify","saveData","dataStr","encodeURIComponent","downloadElem","document","getElementById","setAttribute","open","jsonString","loadedJSON","parse","loadedObjects","newObjects","forEach","item","undefined","name","newVertex","UUID","title","content","sx","sy","width","height","push","newArrow","fromVertexUUID","fromVertexNode","toVertexUUID","toVertexNode","error","e","alert"],"mappings":"AAAA,SAAQA,cAAR,EAAwBC,iBAAxB,QAAgD,0BAAhD;AACA,SAAQC,OAAR,QAAsB,gBAAtB;AAEA,SAAQC,MAAR,QAAqB,0BAArB;AACA,SAAQC,KAAR,QAAoB,yBAApB;AAEA,OAAO,SAASC,IAAT,GAAgB;AAEnBC,EAAAA,OAAO,CAACC,GAAR,CAAYC,IAAI,CAACC,SAAL,CAAeT,cAAf,CAAZ,EAFmB,CAInB;;AACA,MAAIU,QAAQ,GAAG;AACX;AACA;AACA;AACAR,IAAAA,OAAO,EAAEA,OAJE;AAMX;AACAF,IAAAA,cAAc,EAAEA;AAPL,GAAf;AAUA,MAAIW,OAAO,GAAG,kCAAkCC,kBAAkB,CAACJ,IAAI,CAACC,SAAL,CAAeC,QAAf,CAAD,CAAlE;AACA,MAAIG,YAAY,GAAGC,QAAQ,CAACC,cAAT,CAAwB,iBAAxB,CAAnB;AACAF,EAAAA,YAAY,CAACG,YAAb,CAA0B,MAA1B,EAAsCL,OAAtC;AACAE,EAAAA,YAAY,CAACG,YAAb,CAA0B,UAA1B,EAAsC,aAAtC;AACH;AAED,OAAO,SAASC,IAAT,CAAcC,UAAd,EAA0B;AAC7B,MAAIA,UAAU,IAAI,IAAlB,EAAwB;;AACxB,MAAI;AACA;AACA,QAAIC,UAAU,GAAGX,IAAI,CAACY,KAAL,CAAWF,UAAX,CAAjB,CAFA,CAIA;;AACA,QAAIG,aAAa,GAAGF,UAAU,CAACnB,cAA/B,CALA,CAOA;;AACA,QAAIsB,UAAU,GAAG,EAAjB,CARA,CAUA;;AACAD,IAAAA,aAAa,CAACE,OAAd,CAAuBC,IAAD,IAAU;AAC5B,UAAIA,IAAI,KAAKC,SAAb,EAAwB;AACpB,gBAAQD,IAAI,CAACE,IAAb;AACI,eAAK,QAAL;AACI,gBAAIC,SAAS,GAAG,IAAIxB,MAAJ,CAAWqB,IAAI,CAACI,IAAhB,EAAsBJ,IAAI,CAACK,KAA3B,EAAkCL,IAAI,CAACM,OAAvC,EAAgDN,IAAI,CAACO,EAArD,EAAyDP,IAAI,CAACQ,EAA9D,EAAkER,IAAI,CAACS,KAAvE,EAA8ET,IAAI,CAACU,MAAnF,CAAhB;AACAZ,YAAAA,UAAU,CAACa,IAAX,CAAgBR,SAAhB;AACA;;AACJ;AACI;AANR;AAQH;AACJ,KAXD,EAXA,CAwBA;;AACAN,IAAAA,aAAa,CAACE,OAAd,CAAuBC,IAAD,IAAU;AAC5B,UAAIA,IAAI,KAAKC,SAAb,EAAwB;AACpB,gBAAQD,IAAI,CAACE,IAAb;AACI,eAAK,QAAL;AACI;;AACJ,eAAK,OAAL;AACI,gBAAIU,QAAQ,GAAG,IAAIhC,KAAJ,CAAUoB,IAAI,CAACI,IAAf,EAAqBN,UAArB,EAAiCE,IAAI,CAACa,cAAtC,EAAsDb,IAAI,CAACc,cAA3D,EAA2Ed,IAAI,CAACe,YAAhF,EAA8Ff,IAAI,CAACgB,YAAnG,CAAf;AACAlB,YAAAA,UAAU,CAACa,IAAX,CAAgBC,QAAhB;AACA;;AACJ;AACI9B,YAAAA,OAAO,CAACmC,KAAR,CAAc,gCAAd,EAAgDjB,IAAhD;AACA;AATR;AAWH;AACJ,KAdD;AAgBAlB,IAAAA,OAAO,CAACC,GAAR,CAAYe,UAAZ;AACArB,IAAAA,iBAAiB,CAACqB,UAAD,CAAjB;AACH,GA3CD,CA2CE,OAAOoB,CAAP,EAAU;AACRC,IAAAA,KAAK,CAACD,CAAD,CAAL;AACH;AAEJ","sourcesContent":["import {currentObjects, setCurrentObjects} from \"../UIElements/CanvasDraw\"\nimport {version} from \"../MainProgram\"\n\nimport {Vertex} from \"../DataStructures/Vertex\";\nimport {Arrow} from \"../DataStructures/Arrow\";\n\nexport function save() {\n\n    console.log(JSON.stringify(currentObjects));\n\n    // Combine into save data\n    var saveData = {\n        // The version is being saved in the savefile\n        // this is so in future versions, if the serialisation changes\n        // They can upgrade the the file to one compatibile with the newer version\n        version: version,\n\n        // The data here should all have uuids and should be convertible back into their objects.\n        currentObjects: currentObjects,\n    }\n\n    var dataStr = \"data:text/json;charset=utf-8,\" + encodeURIComponent(JSON.stringify(saveData));\n    var downloadElem = document.getElementById('json-downloader');\n    downloadElem.setAttribute(\"href\",     dataStr     );\n    downloadElem.setAttribute(\"download\", \"export.json\");\n}\n\nexport function open(jsonString) {\n    if (jsonString == null) return;\n    try {\n        // TODO Add check to see if there is unsaved progress\n        var loadedJSON = JSON.parse(jsonString);\n\n        // Loaded objects ONLY with variables\n        var loadedObjects = loadedJSON.currentObjects;\n\n        // Loaded objects with variables and functions\n        var newObjects = [];\n\n        // Copy behaviour over (vertexs first)\n        loadedObjects.forEach((item) => {\n            if (item !== undefined) {\n                switch (item.name) {\n                    case \"Vertex\":\n                        var newVertex = new Vertex(item.UUID, item.title, item.content, item.sx, item.sy, item.width, item.height);\n                        newObjects.push(newVertex);\n                        break;\n                    default:\n                        break;\n                }\n            }\n        });\n\n        // Copy behaviour over (everything else)\n        loadedObjects.forEach((item) => {\n            if (item !== undefined) {\n                switch (item.name) {\n                    case \"Vertex\":\n                        break;\n                    case \"Arrow\":\n                        var newArrow = new Arrow(item.UUID, newObjects, item.fromVertexUUID, item.fromVertexNode, item.toVertexUUID, item.toVertexNode);\n                        newObjects.push(newArrow);\n                        break;\n                    default:\n                        console.error(\"Unknown object to deserialise \", item);\n                        break;\n                }\n            }\n        });\n        \n        console.log(newObjects);\n        setCurrentObjects(newObjects);\n    } catch (e) {\n        alert(e);\n    }\n\n}"]},"metadata":{},"sourceType":"module"}